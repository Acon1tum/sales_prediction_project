<!-- templates/dashboard.html -->
{% extends "base.html" %}

{% block title %}Forecastrix | Dashboard{% endblock %}
{% block header_subtitle %}Here's your sales forecast overview{% endblock %}

{% block extra_head %}
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<link rel="stylesheet" href="{{ url_for('static', filename='css/dashboard.css') }}">
{% endblock %}

{% block content %}
<!-- Dashboard Content -->
<section class="dashboard">
    <div class="stats-grid">
        <div class="stat-card primary">
            <h3>Total Forecasts Generated</h3>
            <p class="stat-value" id="total-forecasts">0</p>
            <p class="stat-change" id="forecast-change">+0% from last month</p>
        </div>

        <div class="stat-card" id="recent-forecast-1">
            <div class="card-header">
                <h3>Recent Forecast</h3>
                <span class="date-display" id="date-1">Loading...</span>
            </div>
            <div class="graph-container">
                <canvas id="graph1"></canvas>
            </div>
            <div class="graph-stats">
                <div class="stat-item">
                    <span class="indicator purple"></span>
                    <p>Threshold: <strong id="threshold-1">0</strong></p>
                </div>
                <div class="stat-item">
                    <span class="indicator green"></span>
                    <p>Avg Prediction: <strong id="avg-prediction-1">0</strong></p>
                </div>
            </div>
        </div>
        
        <div class="stat-card" id="recent-forecast-2">
            <div class="card-header">
                <h3>Recent Forecast</h3>
                <span class="date-display" id="date-2">Loading...</span>
            </div>
            <div class="graph-container">
                <canvas id="graph2"></canvas>
            </div>
            <div class="graph-stats">
                <div class="stat-item">
                    <span class="indicator purple"></span>
                    <p>Threshold: <strong id="threshold-2">0</strong></p>
                </div>
                <div class="stat-item">
                    <span class="indicator green"></span>
                    <p>Avg Prediction: <strong id="avg-prediction-2">0</strong></p>
                </div>
            </div>
        </div>
    </div>

    <div style="text-align: right;">
        <a href="{{ url_for('history') }}" class="view-all">View All</a>
    </div>
    <div class="daily-forecasts-section">
        <div class="section-header">
            <h2>Monthly Forecast Activity</h2>
            <div class="filter-controls">
                <select id="year-filter" class="year-filter">
                    <option value="">Loading years...</option>
                </select>
            </div>
           
        </div>
        <div class="graph-container">
            <canvas id="monthly-forecasts-chart"></canvas>
        </div>
    </div>

    <!-- Product Performance Section -->
    <div class="product-performance-section">
        <div class="section-header">
            <h2>Product Performance Analysis</h2>
        </div>
        <div class="performance-grid">
            <!-- Best Performers -->
            <div class="performance-card best">
                <div class="card-header">
                    <h3>Top Performing Products</h3>
                    <span class="badge success">Best</span>
                </div>
                <div class="product-list" id="best-performers">
                    <div class="loading">Loading best performers...</div>
                </div>
            </div>

            <!-- Worst Performers -->
            <div class="performance-card worst">
                <div class="card-header">
                    <h3>Products Needing Attention</h3>
                    <span class="badge warning">Needs Review</span>
                </div>
                <div class="product-list" id="worst-performers">
                    <div class="loading">Loading products needing attention...</div>
                </div>
            </div>
        </div>
    </div>
</section>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/dashboard.js') }}"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
{% endblock %}